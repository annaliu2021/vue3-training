import{P as _}from"./paginationComponent-0bfe6d7a.js";import{_ as g,r as m,o as c,c as a,a as t,t as i,F as b,f as k,b as $}from"./index-881a622c.js";const{VITE_API_ROOT:d,VITE_API_PATH:f}={VITE_API_ROOT:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"annavue",BASE_URL:"/vue3-training",MODE:"production",DEV:!1,PROD:!0},v={data(){return{text:"產品管理",products:[],pagination:{}}},mounted(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");e===void 0||e.length===0?this.$router.push({name:"login"}):(this.$http.defaults.headers.common.Authorization=e,this.checkAdmin())},methods:{getproducts(e=1){const s=`${d}/api/${f}/admin/products?page=${e}`;this.$http.get(s).then(l=>{const{products:r,pagination:n}=l.data;this.products=r,this.pagination=n}).catch(l=>{alert(l.response)})},checkAdmin(){const e=`${d}/api/user/check`;this.$http.post(e).then(()=>{this.getproducts()}).catch(s=>{alert(s.response.data.message),this.$router.push({name:"login"})})}},components:{PaginationComponent:_}},P={class:"container"},y={class:"fs-3 fw-bold text-center mb-3"},T={class:"my-3"},A={class:"table align-middle"},V=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"序號"),t("th",{scope:"col"},"產品分類"),t("th",{scope:"col"},"產品圖片"),t("th",{scope:"col"},"產品名稱"),t("th",{scope:"col"},"產品狀態"),t("th",{scope:"col"},"操作")])],-1),E=["src","alt"],I={class:"text-center"},x={key:0,class:"text-success"},C={key:1},O={class:"btn-group"},D=["onClick"],w=["onClick"];function B(e,s,l,r,n,M){const p=m("pagination-component");return c(),a("div",P,[t("h2",y,i(n.text),1),t("div",T,[t("button",{class:"btn btn-success",onClick:s[0]||(s[0]=o=>e.openModal("new"))}," 建立新的產品 ")]),t("table",A,[V,t("tbody",null,[(c(!0),a(b,null,k(n.products,(o,u)=>(c(),a("tr",{key:o.id},[t("td",null,i(++u),1),t("td",null,i(o.category),1),t("td",null,[t("img",{src:o.imageUrl,class:"table-img",alt:o.title},null,8,E)]),t("td",null,i(o.title),1),t("td",I,[o.is_enabled?(c(),a("span",x,"啟用中")):(c(),a("span",C,"未啟用"))]),t("td",null,[t("div",O,[t("button",{type:"button",class:"btn btn-outline-success btn-sm",onClick:h=>e.openModal("edit",o)}," 編輯 ",8,D),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:h=>e.openModal("delete",o)}," 刪除 ",8,w)])])]))),128))])]),$(p,{pages:n.pagination,onGoToPage:e.getData},null,8,["pages","onGoToPage"])])}const G=g(v,[["render",B]]);export{G as default};
